<nav class="mb-5">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
      <a routerLink="/">Home</a>
    </li>
    <li class="breadcrumb-item">
      <a routerLink="/entries">Lançamentos</a>
    </li>
    <li class="breadcrumb-item active">Formulario de lançamentos</li>
  </ol>
</nav>

<div class="row mb-4">
  <div class="col-md-40">
    <h1 class="h2 border-left pl-2">{{ pageTitle }}</h1>
  </div>

  <div class="col-md">
    <a routerLink="/entries" class="btn btn-light float-right">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="25"
        height="25"
        fill="currentColor"
        class="bi bi-arrow-left-short"
        viewBox="0 0 16 16"
      >
        <path
          fill-rule="evenodd"
          d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z"
        />
      </svg>
      Voltar
    </a>
  </div>
</div>

<form [formGroup]="resourceForm" (submit)="submitForm()">
  <div class="card">
    <div class="card-header">Informações sobre o lançamento</div>
  </div>
  <div class="card-body">
    <div class="form-row">
      <!-- Type -->
      <div class="form-group col-md-2">
        <label for="type">Tipo</label>
        <select
          name="type"
          id="type"
          formControlName="type"
          class="form-control"
        >
          <option *ngFor="let option of typeOptions" [value]="option.value">{{option.text}}</option>

        </select>
        <div
          class="text-danger"
          *ngIf="resourceForm.get('type').invalid && resourceForm.get('type').touched"
        >
          <div *ngIf="resourceForm.get('type').errors.required">
            Dados obrigatório
          </div>
        </div>
      </div>
      <!-- Name -->
      <div class="form-group col-md-5">
        <label for="name">Lançamento</label>
        <input
          type="text"
          name="name"
          id="name"
          class="form-control"
          formControlName="name"
        />
        <div
          class="text-danger"
          *ngIf="resourceForm.get('name').invalid && resourceForm.get('name').touched"
        >
          <div *ngIf="resourceForm.get('name').errors.required">
            Dados obrigatório
          </div>
          <div *ngIf="resourceForm.get('name').errors.minlength">
            deve ter no minimo dois caracteres
          </div>
        </div>
      </div>

      <!-- Valor -->
      <div class="form-group col-md-3">
        <label for="amount">Valor</label>
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">R$</div>
          </div>
          <input
            [imask]="imaskConfig"
            type="text"
            name="amount"
            id="amount"
            class="form-control text-right"
            formControlName="amount"
          />
        </div>

        <div
          class="text-danger"
          *ngIf="
            resourceForm.get('amount').invalid && resourceForm.get('amount').touched
          "
        >
          <div *ngIf="resourceForm.get('amount').errors.required">
            Dados obrigatório
          </div>
        </div>
      </div>

      <!-- Date -->
      <div class="form-group col-md-2">
        <label for="date">Data</label>
        <p-calendar
          id="date"
          formControlName="date"
          inputStyleClass="form-control"
          dataType="string"
          dateFormat = "dd/mm/yy"
          [locale]="ptBR"
          [showButtonBar]="true"
        ></p-calendar>
        <div
          class="text-danger"
          *ngIf="resourceForm.get('date').invalid && resourceForm.get('date').touched"
        >
          <div *ngIf="resourceForm.get('date').errors.required">
            Dados obrigatório
          </div>
        </div>
      </div>
    </div>

    <div class="form-row">

      <!-- Paid -->
      <div class="form-group col-md-2">
        <label for="paid">Pago</label>
        <div class="btn-group">
          <label (click)="resourceForm.get('paid').setValue(true)" [class.active]="resourceForm.get('paid').value === true" class="btn btn-outline-info">Pago</label>
          <label (click)="resourceForm.get('paid').setValue(false)" [class.active]="resourceForm.get('paid').value === false"class="btn btn-outline-info">Pendente</label>
        </div>

        <div
          class="text-danger"
          *ngIf="
            resourceForm.get('paid').invalid && resourceForm.get('paid').touched
          "
        >
          <div *ngIf="resourceForm.get('paid').errors.required">
            Dados obrigatório
          </div>
        </div>
      </div>


       <!-- CategoryId -->
       <div class="form-group col-md-3">
        <label for="categoryId">Categoria</label>
        <select
          name="categoryId"
          id="categoryId"
          formControlName="categoryId"
          class="form-control"
        >
          <option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option>
        </select>
        <div
          class="text-danger"
          *ngIf="resourceForm.get('categoryId').invalid && resourceForm.get('categoryId').touched"
        >
          <div *ngIf="resourceForm.get('categoryId').errors.required">
            Dados obrigatório
          </div>
        </div>
      </div>

      <!-- Description -->
      <div class="form-group col-md-7">
        <label for="description">Descrição</label>
        <input
          type="text"
          id="description"
          class="form-control"
          formControlName="description"
        />
      </div>
    </div>
  </div>

  <div class="alert alert-danger mt-4" *ngIf="serverErrorMessagers">
    <strong>Erro no Servidor</strong>
    <ul>
      <li *ngFor="let error of serverErrorMessagers">{{ error }}</li>
    </ul>
  </div>

  <button
    [disabled]="submitiingForm || resourceForm.invalid"
    type="submit"
    class="btn btn-primary btn-lg float-right at-3"
  >
    Enviar
  </button>
</form>
